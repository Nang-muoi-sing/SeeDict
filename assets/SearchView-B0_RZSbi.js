import{m as C,c as a,b as e,e as o,d as M,F as h,a as y,j as z,r as p,k as H,l as P,p as E,q,w as k,s as T,t as f,i as D,h as x,v as $,u as g}from"./index-B-UcgEeP.js";import{_ as F}from"./PageContent.vue_vue_type_script_setup_true_lang-DjCxIHuO.js";import{_ as U,r as G,t as A}from"./typography-CAP_IBIs.js";import{s as I}from"./phonetics-BQsEnJbI.js";import"./NavBar-Ct8jO9gy.js";import"./SearchBar-DAA_eA6T.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Footer-hIN9t7SY.js";const J={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function K(_,s){return e(),a("svg",J,s[0]||(s[0]=[o("path",{fill:"currentColor",d:"M7.5 22q-1.45 0-2.475-1.025T4 18.5v-13q0-1.45 1.025-2.475T7.5 2H18q.825 0 1.413.587T20 4v12.525q0 .2-.162.363t-.588.362q-.35.175-.55.5t-.2.75t.2.763t.55.487t.55.413t.2.562v.25q0 .425-.288.725T19 22zM9 15q.425 0 .713-.288T10 14V5q0-.425-.288-.712T9 4t-.712.288T8 5v9q0 .425.288.713T9 15m-1.5 5h9.325q-.15-.35-.237-.712T16.5 18.5q0-.4.075-.775t.25-.725H7.5q-.65 0-1.075.438T6 18.5q0 .65.425 1.075T7.5 20"},null,-1)]))}const O=C({name:"material-symbols-book2-rounded",render:K}),Q={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function W(_,s){return e(),a("svg",Q,s[0]||(s[0]=[o("path",{fill:"currentColor",d:"M11.75 19h-.25q-3.55 0-6.025-2.475T3 10.5t2.475-6.025T11.5 2q1.775 0 3.313.662t2.7 1.825t1.824 2.7T20 10.5q0 3.35-1.888 6.225t-4.762 4.5q-.25.125-.5.138t-.45-.113t-.35-.325t-.175-.475zm-.275-3.025q.425 0 .725-.3t.3-.725t-.3-.725t-.725-.3t-.725.3t-.3.725t.3.725t.725.3M9.3 8.375q.275.125.55.013t.45-.363q.225-.3.525-.463T11.5 7.4q.6 0 .975.337t.375.863q0 .325-.187.65t-.663.8q-.625.55-.925 1.038t-.3.987q0 .3.213.513t.512.212t.5-.225t.3-.525q.125-.425.45-.775t.6-.625q.525-.525.788-1.05t.262-1.05q0-1.15-.788-1.85T11.5 6q-.8 0-1.475.388t-1.1 1.062q-.15.275-.038.538t.413.387"},null,-1)]))}const X=C({name:"material-symbols-contact-support-rounded",render:W}),Y=M({__name:"SearchSkeleton",props:{number:{default:10}},setup(_){const s=_;return(w,n)=>(e(),a(h,null,[n[1]||(n[1]=o("div",{class:"animate-pulse"},[o("div",{class:"bg-wheat-200 mb-2.5 h-6 w-[30%] rounded-lg px-2 py-1 sm:w-32"}),o("div",{class:"bg-wheat-100 mb-2 h-3 w-[40%] rounded-lg px-2 sm:w-50"})],-1)),(e(!0),a(h,null,y(s.number,r=>(e(),a("div",{key:r,class:"bg-wheat-100 my-5 px-5 py-4"},n[0]||(n[0]=[z('<div class="animate-pulse"><div class="flex justify-end"><div class="bg-wheat-200 mb-3 h-3 w-[35%] rounded-lg sm:w-32"></div></div><div class="bg-wheat-200 mb-5 h-6 w-[30%] rounded-lg sm:w-28"></div><div class="bg-wheat-200 mb-2.5 h-3 w-[80%] rounded-lg sm:w-85 md:w-135"></div><div class="bg-wheat-200 mb-2.5 h-3 w-[65%] rounded-lg sm:w-70 md:w-105"></div><div class="bg-wheat-200 mb-2.5 h-3 w-[70%] rounded-lg sm:w-75 md:w-120"></div></div>',1)])))),128))],64))}}),Z={class:"bg-wheat-300 mb-2.5 w-fit rounded-lg px-2 py-1 text-xl text-white"},ee={class:"bg-wheat-100 my-5 px-5 py-4"},te={class:"text-wheat-500 flex flex-wrap justify-end gap-2 text-sm"},se={key:0,class:"flex items-center"},ae={class:"text-rosybrown-800 xxl:text-4xl text-3xl font-bold break-all whitespace-normal"},oe={class:"text-wheat-600 mt-2"},ne={key:0,class:"mt-6 text-center"},re=["disabled"],le={key:1,class:"text-wheat-500 mt-6 text-center"},_e=M({__name:"SearchView",setup(_){const s=H(),w=p(!1),n=p(!1),r=p([]),c=p(null),m=p(!1),v=p({q:s.query.q||""}),S=P(()=>({status:0,data:{q:v.value.q,results:r.value,next_cursor:c.value,has_more:m.value}})),R=()=>{document.title=s.query.q?`${s.query.q} - 检索`:"米时典 SeeDict - 检索"},V=async()=>{w.value=!0,r.value=[],c.value=null,m.value=!1;try{const t=new URLSearchParams;t.append("q",v.value.q);const i=`https://i.seedict.com/api/v1/search?${t}`,l=await fetch(i);if(!l.ok)throw new Error(`HTTP错误: ${l.status}`);const u=await l.json();r.value=u.data.results||[],c.value=u.data.nextCursor||null,m.value=u.data.hasMore||!1}catch(t){console.error("搜索请求失败:",t)}finally{w.value=!1}},B=async()=>{if(!(!c.value||n.value)){n.value=!0;try{const t=new URLSearchParams;t.append("q",v.value.q),t.append("cursor",c.value);const i=`https://i.seedict.com/api/v1/search?${t}`,l=await fetch(i);if(!l.ok)throw new Error(`HTTP错误: ${l.status}`);const u=await l.json();r.value=[...r.value,...u.data.results||[]],c.value=u.data.nextCursor||null,m.value=u.data.hasMore||!1}catch(t){console.error("加载更多失败:",t)}finally{n.value=!1}}};return E(()=>s.query.q,t=>{typeof t=="string"&&(v.value.q=t,R(),V())},{immediate:!0}),(t,i)=>{const l=X,u=O,j=D("RouterLink");return e(),q(F,null,{default:k(()=>[w.value?(e(),q(Y,{key:0})):(e(),a(h,{key:1},[o("div",Z," 查询："+f(v.value.q),1),(e(!0),a(h,null,y(S.value.data.results,d=>(e(),q(j,{class:"block",to:{name:"word",query:{w:d.w}},key:d.w},{default:k(()=>{var b;return[o("div",ee,[o("div",te,[((b=d.refs)==null?void 0:b.length)==0&&!d.brief?(e(),a("span",se,[x(l,{style:{"font-size":"16px"}}),i[0]||(i[0]=$(" 暂未释义"))])):(e(!0),a(h,{key:1},y(d.refs,(L,N)=>(e(),a("span",{class:"flex items-center",key:N},[x(u,{style:{"font-size":"16px"}}),$(" "+f(g(I)[L]??""),1)]))),128))]),o("div",ae,[x(U,{text:d.text,yngping:d.pron},null,8,["text","yngping"])]),o("p",oe,f(g(G)(g(A)(d.brief))),1)])]}),_:2},1032,["to"]))),128)),!n.value&&m.value?(e(),a("div",ne,[o("button",{onClick:B,disabled:n.value,class:"bg-wheat-300 hover:bg-wheat-400 disabled:bg-wheat-200 rounded-lg px-6 py-3 text-white"},i[1]||(i[1]=[o("span",null,"加载更多",-1)]),8,re)])):T("",!0),!m.value&&r.value.length>0?(e(),a("div",le," 已显示所有 "+f(r.value.length)+" 条结果 ",1)):T("",!0)],64))]),_:1})}}});export{_e as default};
