var oe=Object.defineProperty;var re=(t,e,o)=>e in t?oe(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var T=(t,e,o)=>re(t,typeof e!="symbol"?e+"":e,o);import{_ as J}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{c as b,b as g,e as v,s as ne,h as A,w as se,i as le,q as ie,m as U,v as B,D as ce,E as ae,G as ue,H as de,r as C,I as fe,j as D,J as p,u as Y,K as X,d as he,o as me,g as ve,B as H,l as R,L as S,M as pe,F as we,a as ye,C as V,y as be,t as ge}from"./index-Dx6FdZGn.js";const _e={},xe={class:"flex h-full flex-row justify-between rounded-lg bg-white"},Te={class:"hover:bg-wheat-50 text-rosybrown-600 hover:text-rosybrown-800 m-1 content-center rounded-xs px-3 py-1.5 font-bold transition-all ease-in-out"};function ke(t,e){const o=le("RouterLink");return g(),b("div",xe,[v("div",Te,[A(o,{to:{name:"home"}},{default:se(()=>e[0]||(e[0]=[ie("主页")])),_:1})]),e[1]||(e[1]=ne('<div class="hover:bg-wheat-50 text-rosybrown-600 hover:text-rosybrown-800 m-1 content-center rounded-xs px-3 py-1.5 font-bold transition-all ease-in-out"><a href="#">入门</a></div><div class="hover:bg-wheat-50 text-rosybrown-600 hover:text-rosybrown-800 m-1 content-center rounded-xs px-3 py-1.5 font-bold transition-all ease-in-out"><a href="#">帮助</a></div><div class="hover:bg-wheat-50 text-rosybrown-600 hover:text-rosybrown-800 m-1 content-center rounded-xs px-3 py-1.5 font-bold transition-all ease-in-out"><a href="#">关于</a></div>',3))])}const Ye=J(_e,[["render",ke]]),Oe={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Ee(t,e){return g(),b("svg",Oe,e[0]||(e[0]=[v("path",{fill:"currentColor",d:"M12 21q-3.15 0-5.575-1.912T3.275 14.2q-.1-.375.15-.687t.675-.363q.4-.05.725.15t.45.6q.6 2.25 2.475 3.675T12 19q2.925 0 4.963-2.037T19 12t-2.037-4.962T12 5q-1.725 0-3.225.8T6.25 8H8q.425 0 .713.288T9 9t-.288.713T8 10H4q-.425 0-.712-.288T3 9V5q0-.425.288-.712T4 4t.713.288T5 5v1.35q1.275-1.6 3.113-2.475T12 3q1.875 0 3.513.713t2.85 1.924t1.925 2.85T21 12t-.712 3.513t-1.925 2.85t-2.85 1.925T12 21m1-9.4l2.5 2.5q.275.275.275.7t-.275.7t-.7.275t-.7-.275l-2.8-2.8q-.15-.15-.225-.337T11 11.975V8q0-.425.288-.712T12 7t.713.288T13 8z"},null,-1)]))}const Se=U({name:"material-symbols-history-rounded",render:Ee}),Ce={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function We(t,e){return g(),b("svg",Ce,e[0]||(e[0]=[v("path",{fill:"currentColor",d:"M9.5 16q-2.725 0-4.612-1.888T3 9.5t1.888-4.612T9.5 3t4.613 1.888T16 9.5q0 1.1-.35 2.075T14.7 13.3l5.6 5.6q.275.275.275.7t-.275.7t-.7.275t-.7-.275l-5.6-5.6q-.75.6-1.725.95T9.5 16m0-2q1.875 0 3.188-1.312T14 9.5t-1.312-3.187T9.5 5T6.313 6.313T5 9.5t1.313 3.188T9.5 14"},null,-1)]))}const qe=U({name:"material-symbols-search-rounded",render:We});function K(t){return ce()?(ae(t),!0):!1}const Q=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const ze=Object.prototype.toString,He=t=>ze.call(t)==="[object Object]",y=()=>{},P=Ie();function Ie(){var t,e;return Q&&((t=window==null?void 0:window.navigator)==null?void 0:t.userAgent)&&(/iP(?:ad|hone|od)/.test(window.navigator.userAgent)||((e=window==null?void 0:window.navigator)==null?void 0:e.maxTouchPoints)>2&&/iPad|Macintosh/.test(window==null?void 0:window.navigator.userAgent))}function De(...t){if(t.length!==1)return ue(...t);const e=t[0];return typeof e=="function"?de(fe(()=>({get:e,set:y}))):C(e)}function M(t){return Array.isArray(t)?t:[t]}function Ne(t,e,o){return B(t,e,{...o,immediate:!0})}const Z=Q?window:void 0;function W(t){var e;const o=p(t);return(e=o==null?void 0:o.$el)!=null?e:o}function k(...t){const e=[],o=()=>{e.forEach(l=>l()),e.length=0},r=(l,i,a,h)=>(l.addEventListener(i,a,h),()=>l.removeEventListener(i,a,h)),s=D(()=>{const l=M(p(t[0])).filter(i=>i!=null);return l.every(i=>typeof i!="string")?l:void 0}),d=Ne(()=>{var l,i;return[(i=(l=s.value)==null?void 0:l.map(a=>W(a)))!=null?i:[Z].filter(a=>a!=null),M(p(s.value?t[1]:t[0])),M(Y(s.value?t[2]:t[1])),p(s.value?t[3]:t[2])]},([l,i,a,h])=>{if(o(),!(l!=null&&l.length)||!(i!=null&&i.length)||!(a!=null&&a.length))return;const O=He(h)?{...h}:h;e.push(...l.flatMap(_=>i.flatMap(w=>a.map(E=>r(_,w,E,O)))))},{flush:"post"}),f=()=>{d(),o()};return K(o),f}let F=!1;function G(t,e,o={}){const{window:r=Z,ignore:s=[],capture:d=!0,detectIframe:f=!1,controls:l=!1}=o;if(!r)return l?{stop:y,cancel:y,trigger:y}:y;if(P&&!F){F=!0;const c={passive:!0};Array.from(r.document.body.children).forEach(n=>k(n,"click",y,c)),k(r.document.documentElement,"click",y,c)}let i=!0;const a=c=>p(s).some(n=>{if(typeof n=="string")return Array.from(r.document.querySelectorAll(n)).some(u=>u===c.target||c.composedPath().includes(u));{const u=W(n);return u&&(c.target===u||c.composedPath().includes(u))}});function h(c){const n=p(c);return n&&n.$.subTree.shapeFlag===16}function O(c,n){const u=p(c),m=u.$.subTree&&u.$.subTree.children;return m==null||!Array.isArray(m)?!1:m.some(x=>x.el===n.target||n.composedPath().includes(x.el))}const _=c=>{const n=W(t);if(c.target!=null&&!(!(n instanceof Element)&&h(t)&&O(t,c))&&!(!n||n===c.target||c.composedPath().includes(n))){if("detail"in c&&c.detail===0&&(i=!a(c)),!i){i=!0;return}e(c)}};let w=!1;const E=[k(r,"click",c=>{w||(w=!0,setTimeout(()=>{w=!1},0),_(c))},{passive:!0,capture:d}),k(r,"pointerdown",c=>{const n=W(t);i=!a(c)&&!!(n&&!c.composedPath().includes(n))},{passive:!0}),f&&k(r,"blur",c=>{setTimeout(()=>{var n;const u=W(t);((n=r.document.activeElement)==null?void 0:n.tagName)==="IFRAME"&&!(u!=null&&u.contains(r.document.activeElement))&&e(c)},0)},{passive:!0})].filter(Boolean),z=()=>E.forEach(c=>c());return l?{stop:z,cancel:()=>{i=!1},trigger:c=>{i=!0,_(c),i=!1}}:z}const Le={mounted(t,e){const o=!e.modifiers.bubble;if(typeof e.value=="function")t.__onClickOutside_stop=G(t,e.value,{capture:o});else{const[r,s]=e.value;t.__onClickOutside_stop=G(t,r,Object.assign({capture:o},s))}},unmounted(t){t.__onClickOutside_stop()}};function $(t){return typeof Window<"u"&&t instanceof Window?t.document.documentElement:typeof Document<"u"&&t instanceof Document?t.documentElement:t}function ee(t){const e=window.getComputedStyle(t);if(e.overflowX==="scroll"||e.overflowY==="scroll"||e.overflowX==="auto"&&t.clientWidth<t.scrollWidth||e.overflowY==="auto"&&t.clientHeight<t.scrollHeight)return!0;{const o=t.parentNode;return!o||o.tagName==="BODY"?!1:ee(o)}}function Me(t){const e=t||window.event,o=e.target;return ee(o)?!1:e.touches.length>1?!0:(e.preventDefault&&e.preventDefault(),!1)}const j=new WeakMap;function $e(t,e=!1){const o=X(e);let r=null,s="";B(De(t),l=>{const i=$(p(l));if(i){const a=i;if(j.get(a)||j.set(a,a.style.overflow),a.style.overflow!=="hidden"&&(s=a.style.overflow),a.style.overflow==="hidden")return o.value=!0;if(o.value)return a.style.overflow="hidden"}},{immediate:!0});const d=()=>{const l=$(p(t));!l||o.value||(P&&(r=k(l,"touchmove",i=>{Me(i)},{passive:!1})),l.style.overflow="hidden",o.value=!0)},f=()=>{const l=$(p(t));!l||!o.value||(P&&(r==null||r()),l.style.overflow=s,j.delete(l),o.value=!1)};return K(f),D({get(){return o.value},set(l){l?d():f()}})}function je(){let t=!1;const e=X(!1);return(o,r)=>{if(e.value=r.value,t)return;t=!0;const s=$e(o,r.value);B(e,d=>s.value=d)}}je();class I{constructor(){T(this,"children");T(this,"isEndOfWord");T(this,"timestamp");this.children={},this.isEndOfWord=!1,this.timestamp=null}}class q{constructor(){T(this,"root");T(this,"size");this.root=new I,this.size=0}clear(){this.root=new I,this.size=0}insert(e){let o=this.root;for(const r of e)o.children[r]||(o.children[r]=new I),o=o.children[r];o.isEndOfWord||this.size++,o.isEndOfWord=!0,o.timestamp=Date.now()}delete(e){const o=(r,s)=>{if(s===e.length)return r.isEndOfWord?(r.isEndOfWord=!1,this.size--,Object.keys(r.children).length===0):!1;const d=e[s],f=r.children[d];return f&&o(f,s+1)?(delete r.children[d],Object.keys(r.children).length===0):!1};o(this.root,0)}findWords(e){let o=this.root;for(const r of e){if(!o.children[r])return[];o=o.children[r]}return this.collectWords(o,e)}collectWords(e,o){const r=[];e.isEndOfWord&&e.timestamp&&r.push({word:o,timestamp:e.timestamp});for(const s in e.children)r.push(...this.collectWords(e.children[s],o+s));return r}serialize(){function e(o){return{isEndOfWord:o.isEndOfWord,timestamp:o.timestamp,children:Object.fromEntries(Object.entries(o.children).map(([r,s])=>[r,e(s)]))}}return JSON.stringify(e(this.root))}static deserialize(e){const o=new q;function r(s){const d=new I;d.isEndOfWord=s.isEndOfWord,d.timestamp=s.timestamp;for(const[f,l]of Object.entries(s.children))d.children[f]=r(l);return d}return o.root=r(JSON.parse(e)),o}}const Ae={class:"outline-rosybrown-300 absolute top-full right-0 left-0 rounded-b-md bg-white pt-2 outline"},Pe=["onClick"],Be={class:"text-rosybrown-600 overflow-hidden text-ellipsis"},Re=["onClick"],Ve={class:"flex flex-row-reverse items-baseline px-4 py-1"},Fe=he({__name:"SearchBar",setup(t){const e=be(),o=C(""),r=C([]),s=C(!1),d=C(!1),f=()=>{s.value=!1};me(()=>{window.addEventListener("scroll",f)}),ve(()=>{window.removeEventListener("scroll",f)});const i=(n=>{try{return n?q.deserialize(n):new q}catch(u){return console.error("反序列化前缀树时出错:",u),new q}})(localStorage.getItem("searchHistory")),a=()=>{const n=o.value;if(n){i.insert(n);try{localStorage.setItem("searchHistory",i.serialize())}finally{o.value=""}}s.value=!1,d.value=!1,e.push({name:"search",query:{q:n}})},h=()=>{s.value=!0;const n=o.value,u=i.findWords(n);if(u.length<2){r.value=u.map(m=>m.word);return}u.sort((m,x)=>x.timestamp-m.timestamp),r.value=u.map(m=>m.word).slice(0,10)},O=n=>{o.value=r.value[n],a()},_=n=>{i.delete(r.value.splice(n,1)[0]),localStorage.setItem("searchHistory",i.serialize())},w=()=>{r.value=[],i.clear(),localStorage.removeItem("searchHistory")},E=n=>{n.target.tagName==="INPUT"&&(s.value=!0,d.value=!0)},z=D(()=>s.value&&r.value.length>0?["rounded-b-none","rounded-t-[24px]"]:["rounded-[3rem]"]),c=D(()=>s.value?["backdrop-blur-xs","backdrop-brightness-90"]:["hidden"]);return(n,u)=>{const m=qe,x=Se;return g(),b("div",null,[v("div",{class:R(["fixed top-0 left-0 z-50 h-screen w-screen",c.value])},null,2),H((g(),b("form",{class:R(["outline-rosybrown-300 hover:outline-rosybrown-400 relative z-100 flex h-12 flex-row items-center space-x-2 bg-white px-3 outline-2 hover:outline-3",z.value]),onSubmit:S(a,["prevent"]),onClick:E},[A(m,{width:"28",height:"28",class:"text-rosybrown-400 hover:text-rosybrown-700 cursor-pointer pl-1",onClick:S(a,["stop"])}),H(v("input",{class:"text-rosybrown-800 h-full w-full","onUpdate:modelValue":u[0]||(u[0]=N=>o.value=N),onInput:h,onFocus:h},null,544),[[pe,o.value,void 0,{trim:!0}]]),H(v("ul",Ae,[(g(!0),b(we,null,ye(r.value,(N,L)=>(g(),b("li",{key:L,class:"hover:border-l-rosybrown-700 hover:text-rosybrown-700 hover:bg-rosybrown-50 box-border flex flex-row items-center justify-between border-l-3 border-l-transparent px-4 py-1"},[v("div",{class:"flex w-7/8 cursor-pointer flex-row items-center font-sans",onClick:S(te=>O(L),["stop"])},[A(x,{class:"text-rosybrown-400 pr-4",style:{width:"40px"}}),v("div",Be,ge(N),1)],8,Pe),v("div",{class:"text-rosybrown-300 hover:text-rosybrown-500 cursor-pointer text-sm hover:underline",onClick:S(te=>_(L),["stop"])}," 删除 ",8,Re)]))),128)),H(v("li",Ve,[v("div",{class:"text-rosybrown-300 hover:text-rosybrown-500 cursor-pointer text-xs",onClick:S(w,["stop"])}," 清空历史 ")],512),[[V,s.value&&r.value.length>0]])],512),[[V,s.value&&r.value.length>0]])],34)),[[Y(Le),()=>{s.value=!1}]])])}}}),Xe=J(Fe,[["__scopeId","data-v-d97f6dc4"]]);export{Ye as N,Xe as S};
