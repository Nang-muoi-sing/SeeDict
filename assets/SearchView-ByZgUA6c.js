import{m as x,c as r,b as e,e as o,d as S,j as V,k as H,h as g,u as _,R as b,l as k,p as B,w as q,F as h,a as v,q as R,t as w,s as I,r as P,v as M,o as D,x as T,i as E,y as F}from"./index-DLIeYF6m.js";import{_ as U}from"./PageContent.vue_vue_type_script_setup_true_lang-BmztiFjV.js";import{s as Y,m as A}from"./typography-CjWSCFAn.js";import"./NavBar-BgoN-geY.js";import"./SearchBar-QQHU0PZx.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const G={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function J(c,t){return e(),r("svg",G,t[0]||(t[0]=[o("path",{fill:"currentColor",d:"M7.5 22q-1.45 0-2.475-1.025T4 18.5v-13q0-1.45 1.025-2.475T7.5 2H18q.825 0 1.413.587T20 4v12.525q0 .2-.162.363t-.588.362q-.35.175-.55.5t-.2.75t.2.763t.55.487t.55.413t.2.562v.25q0 .425-.288.725T19 22zM9 15q.425 0 .713-.288T10 14V5q0-.425-.288-.712T9 4t-.712.288T8 5v9q0 .425.288.713T9 15m-1.5 5h9.325q-.15-.35-.237-.712T16.5 18.5q0-.4.075-.775t.25-.725H7.5q-.65 0-1.075.438T6 18.5q0 .65.425 1.075T7.5 20"},null,-1)]))}const K=x({name:"material-symbols-book2-rounded",render:J}),O={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function W(c,t){return e(),r("svg",O,t[0]||(t[0]=[o("path",{fill:"currentColor",d:"M11.75 19h-.25q-3.55 0-6.025-2.475T3 10.5t2.475-6.025T11.5 2q1.775 0 3.313.662t2.7 1.825t1.824 2.7T20 10.5q0 3.35-1.888 6.225t-4.762 4.5q-.25.125-.5.138t-.45-.113t-.35-.325t-.175-.475zm-.275-3.025q.425 0 .725-.3t.3-.725t-.3-.725t-.725-.3t-.725.3t-.3.725t.3.725t.725.3M9.3 8.375q.275.125.55.013t.45-.363q.225-.3.525-.463T11.5 7.4q.6 0 .975.337t.375.863q0 .325-.187.65t-.663.8q-.625.55-.925 1.038t-.3.987q0 .3.213.513t.512.212t.5-.225t.3-.525q.125-.425.45-.775t.6-.625q.525-.525.788-1.05t.262-1.05q0-1.15-.788-1.85T11.5 6q-.8 0-1.475.388t-1.1 1.062q-.15.275-.038.538t.413.387"},null,-1)]))}const X=x({name:"material-symbols-contact-support-rounded",render:W}),Z={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Q(c,t){return e(),r("svg",Z,t[0]||(t[0]=[o("path",{fill:"currentColor",d:"m14.475 12l-7.35-7.35q-.375-.375-.363-.888t.388-.887t.888-.375t.887.375l7.675 7.7q.3.3.45.675t.15.75t-.15.75t-.45.675l-7.7 7.7q-.375.375-.875.363T7.15 21.1t-.375-.888t.375-.887z"},null,-1)]))}const tt=x({name:"material-symbols-arrow-forward-ios-rounded",render:Q}),et={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function st(c,t){return e(),r("svg",et,t[0]||(t[0]=[o("path",{fill:"currentColor",d:"m9.55 12l7.35 7.35q.375.375.363.875t-.388.875t-.875.375t-.875-.375l-7.7-7.675q-.3-.3-.45-.675t-.15-.75t.15-.75t.45-.675l7.7-7.7q.375-.375.888-.363t.887.388t.375.875t-.375.875z"},null,-1)]))}const at=x({name:"material-symbols-arrow-back-ios-new-rounded",render:st}),ot={key:0,class:"text-center"},rt={class:"text-rosybrown-800 inline-flex space-x-2 text-sm"},nt={class:""},lt={key:0,class:"flex h-8 cursor-default items-center justify-center px-2"},ut={key:1},$=7,j=5,it=S({__name:"Pagination",props:{curPage:{},totalPage:{}},setup(c){const t=c,f=B(),i=V(()=>{const{curPage:n,totalPage:l}=t,u=[];if(l<=$){for(let s=1;s<=l;s++)u.push(s);return u}if(u.push(1),n<$-2){for(let s=2;s<=$;s++)u.push(s);return u}u.push("...");const y=Math.min(l,n+(j-1)/2),a=y-j+1;for(let s=a;s<=y;s++)u.push(s);return u});return(n,l)=>{const u=at,y=tt;return t.totalPage>1?(e(),r("nav",ot,[o("ul",rt,[o("li",nt,[g(_(b),{to:{name:"search",query:{..._(f).query,page:t.curPage-1}},class:k(["text-rosybrown-600 flex h-8 w-8 items-center justify-center rounded-full leading-tight",{"cursor-default opacity-50":t.curPage===1,"hover:text-rosybrown-800":t.curPage>1}]),disabled:t.curPage===1},{default:q(()=>[g(u)]),_:1},8,["to","class","disabled"])]),(e(!0),r(h,null,v(i.value,a=>(e(),r(h,{key:a},[a==="..."?(e(),r("li",lt,l[0]||(l[0]=[o("span",null,"…",-1)]))):(e(),r("li",ut,[g(_(b),{to:{name:"search",query:{..._(f).query,page:a}},class:k(["flex h-8 w-8 items-center justify-center rounded-full leading-tight",{"bg-rosybrown-800 text-wheat-50":a===t.curPage,"hover:bg-wheat-100":a!==t.curPage}])},{default:q(()=>[R(w(a),1)]),_:2},1032,["to","class"])]))],64))),128)),o("li",null,[g(_(b),{to:{name:"search",query:{..._(f).query,page:t.curPage+1}},class:k(["text-rosybrown-600 flex h-8 w-8 items-center justify-center rounded-full leading-tight",{"cursor-default opacity-50":t.curPage===t.totalPage,"hover:text-rosybrown-800":t.curPage<t.totalPage}]),disabled:t.curPage===t.totalPage},{default:q(()=>[g(y)]),_:1},8,["to","class","disabled"])])])])):H("",!0)}}}),ct=S({__name:"SearchSkeleton",props:{number:{default:10}},setup(c){const t=c;return(f,i)=>(e(),r(h,null,[i[1]||(i[1]=o("div",{class:"animate-pulse"},[o("div",{class:"bg-wheat-200 mb-2.5 h-6 w-32 rounded-lg px-2 py-1"}),o("div",{class:"bg-wheat-100 mb-2 h-3 w-50 rounded-lg px-2"})],-1)),(e(!0),r(h,null,v(t.number,n=>(e(),r("div",{key:n,class:"bg-wheat-100 my-5 px-5 py-4"},i[0]||(i[0]=[I('<div class="animate-pulse"><div class="flex justify-end"><div class="bg-wheat-200 mb-3 h-3 w-32 rounded-lg"></div></div><div class="bg-wheat-200 mb-5 h-6 w-28 rounded-lg"></div><div class="bg-wheat-200 mb-2.5 h-3 w-135 rounded-lg"></div><div class="bg-wheat-200 mb-2.5 h-3 w-105 rounded-lg"></div><div class="bg-wheat-200 mb-2.5 h-3 w-120 rounded-lg"></div></div>',1)])))),128))],64))}}),dt={class:"bg-wheat-300 mb-2.5 w-fit rounded-lg px-2 py-1 text-xl text-white"},pt={class:"text-rosybrown-600 mb-2 px-2 text-sm"},mt={class:"bg-wheat-100 my-5 px-5 py-4"},_t={class:"text-wheat-500 flex flex-wrap justify-end gap-2 text-sm"},gt={key:0,class:"flex items-center"},ht={class:"ruby-container text-rosybrown-800 xxl:text-4xl text-3xl font-bold break-all whitespace-normal"},ft=["innerHTML"],yt={class:"text-wheat-600 mt-2"},Pt=S({__name:"SearchView",setup(c){const t=B(),f=F(),i=P(!1),n=P({q:t.query.q||"",page:parseInt(t.query.page||"1",10)}),l=P({status:0,data:{q:"",currentPage:0,totalPage:0,totalResult:0,results:[]}}),u=()=>{document.title=t.query.q?`${t.query.q} - 检索`:"米时典 SeeDict - 检索"},y=async()=>{i.value=!0;try{const a=new URLSearchParams;a.append("q",n.value.q),n.value.page>1&&a.append("page",n.value.page.toString());const s=`https://seedict.com/api/v1/search?${a}`,d=await fetch(s);if(!d.ok)throw new Error(`HTTP错误: ${d.status}`);const p=await d.json();l.value=p,n.value.page>1&&p.data.totalResult===0&&(n.value.page=1,f.push({query:{q:n.value.q,page:1}}))}catch(a){console.error("搜索请求失败:",a)}finally{i.value=!1}};return M([()=>t.query.q,()=>t.query.page],([a,s])=>{typeof a=="string"&&(n.value.q=a);let d=1;if(typeof s=="string"){const p=parseInt(s,10);!isNaN(p)&&p>0&&(d=p)}n.value.page=d,n.value.q&&y()},{immediate:!0}),D(()=>{u()}),M(()=>t.query.q,u),(a,s)=>{const d=X,p=K,N=E("RouterLink");return e(),T(U,null,{default:q(()=>[i.value?(e(),T(ct,{key:0})):(e(),r(h,{key:1},[o("div",dt," 查询："+w(n.value.q),1),o("span",pt,w(l.value.data.totalResult?`共 ${l.value.data.totalResult} 个相关结果`:"没有找到相关结果"),1),(e(!0),r(h,null,v(l.value.data.results,m=>(e(),T(N,{class:"block",to:{name:"word",query:{w:m.w}},key:m.w},{default:q(()=>{var C;return[o("div",mt,[o("div",_t,[((C=m.refs)==null?void 0:C.length)==0&&!m.brief?(e(),r("span",gt,[g(d,{style:{"font-size":"16px"}}),s[0]||(s[0]=R(" 暂未释义"))])):(e(!0),r(h,{key:1},v(m.refs,(z,L)=>(e(),r("span",{class:"flex items-center",key:L},[g(p,{style:{"font-size":"16px"}}),R(" "+w(_(Y)[z]??""),1)]))),128))]),o("div",ht,[o("ruby",{innerHTML:_(A)(m.text,m.pron,"text-rosybrown-700"),style:{"ruby-align":"center"}},null,8,ft)]),o("p",yt,w(m.brief),1)])]}),_:2},1032,["to"]))),128)),g(it,{"cur-page":l.value.data.currentPage,"total-page":l.value.data.totalPage},null,8,["cur-page","total-page"])],64))]),_:1})}}});export{Pt as default};
