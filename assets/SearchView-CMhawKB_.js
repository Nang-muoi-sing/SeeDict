import{m as R,c as a,f as e,g as t,a as V,F as f,e as k,p as P,b as d,q as U,s as H,w as E,v as b,i as S,x as j,t as _,j as J,h as g,y as x,u as y,z as A}from"./index-CSzWcP5K.js";import{s as W,_ as Y}from"./RubyText-CrgjfLvQ.js";import{_ as G}from"./PageContent.vue_vue_type_script_setup_true_lang-FRPtlKVp.js";import{a as I,p as K}from"./typography-h-RIw6dn.js";import"./SearchBar-S212p7GF.js";const O={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Q(w,o){return e(),a("svg",O,o[0]||(o[0]=[t("path",{fill:"currentColor",d:"M7.5 22q-1.45 0-2.475-1.025T4 18.5v-13q0-1.45 1.025-2.475T7.5 2H18q.825 0 1.413.587T20 4v12.525q0 .2-.162.363t-.588.362q-.35.175-.55.5t-.2.75t.2.763t.55.487t.55.413t.2.562v.25q0 .425-.288.725T19 22zM9 15q.425 0 .713-.288T10 14V5q0-.425-.288-.712T9 4t-.712.288T8 5v9q0 .425.288.713T9 15m-1.5 5h9.325q-.15-.35-.237-.712T16.5 18.5q0-.4.075-.775t.25-.725H7.5q-.65 0-1.075.438T6 18.5q0 .65.425 1.075T7.5 20"},null,-1)]))}const X=R({name:"material-symbols-book2-rounded",render:Q}),Z={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function ee(w,o){return e(),a("svg",Z,o[0]||(o[0]=[t("path",{fill:"currentColor",d:"M11.75 19h-.25q-3.55 0-6.025-2.475T3 10.5t2.475-6.025T11.5 2q1.775 0 3.313.662t2.7 1.825t1.824 2.7T20 10.5q0 3.35-1.888 6.225t-4.762 4.5q-.25.125-.5.138t-.45-.113t-.35-.325t-.175-.475zm-.275-3.025q.425 0 .725-.3t.3-.725t-.3-.725t-.725-.3t-.725.3t-.3.725t.3.725t.725.3M9.3 8.375q.275.125.55.013t.45-.363q.225-.3.525-.463T11.5 7.4q.6 0 .975.337t.375.863q0 .325-.187.65t-.663.8q-.625.55-.925 1.038t-.3.987q0 .3.213.513t.512.212t.5-.225t.3-.525q.125-.425.45-.775t.6-.625q.525-.525.788-1.05t.262-1.05q0-1.15-.788-1.85T11.5 6q-.8 0-1.475.388t-1.1 1.062q-.15.275-.038.538t.413.387"},null,-1)]))}const te=R({name:"material-symbols-contact-support-rounded",render:ee}),se=V({__name:"SearchSkeleton",props:{number:{default:10}},setup(w){const o=w;return(v,l)=>(e(),a(f,null,[l[1]||(l[1]=t("div",{class:"animate-pulse"},[t("div",{class:"bg-wheat-200 mb-2.5 h-6 w-[30%] rounded-lg px-2 py-1 sm:w-32"}),t("div",{class:"bg-wheat-100 mb-2 h-3 w-[40%] rounded-lg px-2 sm:w-50"})],-1)),(e(!0),a(f,null,k(o.number,u=>(e(),a("div",{key:u,class:"bg-wheat-100 my-5 px-5 py-4"},l[0]||(l[0]=[P('<div class="animate-pulse"><div class="flex justify-end"><div class="bg-wheat-200 mb-3 h-3 w-[35%] rounded-lg sm:w-32"></div></div><div class="bg-wheat-200 mb-5 h-6 w-[30%] rounded-lg sm:w-28"></div><div class="bg-wheat-200 mb-2.5 h-3 w-[80%] rounded-lg sm:w-85 md:w-135"></div><div class="bg-wheat-200 mb-2.5 h-3 w-[65%] rounded-lg sm:w-70 md:w-105"></div><div class="bg-wheat-200 mb-2.5 h-3 w-[70%] rounded-lg sm:w-75 md:w-120"></div></div>',1)])))),128))],64))}}),ae={class:"bg-wheat-300 mb-2.5 w-fit rounded-lg px-2 py-1 text-xl text-white"},ne={class:"bg-wheat-100 my-5 px-5 py-4"},oe={class:"text-wheat-500 flex flex-wrap justify-end gap-2 text-sm"},re={key:0,class:"flex items-center"},le={class:"text-rosybrown-800 xxl:text-4xl text-3xl font-bold break-all whitespace-normal"},ie={class:"text-wheat-600 mt-2"},ue={key:0,class:"mt-6 text-center"},ce=["disabled"],de={key:1,class:"text-wheat-500 mt-6 text-center"},we=V({__name:"SearchView",setup(w){const o="https://i.seedict.com/api/v1",v=U(),l=d(!1),u=d(!1),T=d([]),c=d([]),m=d(null),p=d(!1),q=d({q:v.query.q||""}),$=H(()=>({status:0,data:{queries:T.value.join("、"),results:c.value,nextCursor:m.value,hasMore:p.value}})),B=()=>{document.title=v.query.q?"".concat(v.query.q," - 检索"):"米时典 SeeDict - 检索"},z=async()=>{l.value=!0,c.value=[],m.value=null,p.value=!1;try{const s=new URLSearchParams;s.append("q",q.value.q);const n="https://i.seedict.com/api/v1/search/?".concat(s),r=await fetch(n);if(!r.ok)throw new Error("HTTP错误: ".concat(r.status));const h=await r.json();T.value=h.data.queries||[],c.value=h.data.results||[],m.value=h.data.nextCursor||null,p.value=h.data.hasMore||!1}catch(s){console.error("搜索请求失败:",s)}finally{l.value=!1}},L=async()=>{if(!(!m.value||u.value)){u.value=!0;try{const s=new URLSearchParams;s.append("q",q.value.q),s.append("cursor",m.value);const n=await fetch("".concat(o,"/search/?").concat(s));if(!n.ok)throw new Error("HTTP错误: ".concat(n.status));const r=await n.json();c.value=[...c.value,...r.data.results||[]],m.value=r.data.nextCursor||null,p.value=r.data.hasMore||!1}catch(s){console.error("加载更多失败:",s)}finally{u.value=!1}}};return E(()=>v.query.q,s=>{typeof s=="string"&&(q.value.q=s,B(),z())},{immediate:!0}),(s,n)=>{const r=te,h=X,D=J("RouterLink");return e(),b(G,null,{default:S(()=>[l.value?(e(),b(se,{key:0})):(e(),a(f,{key:1},[t("div",ae," 查询："+_($.value.data.queries),1),(e(!0),a(f,null,k($.value.data.results,i=>(e(),b(D,{class:"block",to:{name:"word",query:{w:i.w}},key:i.w},{default:S(()=>{var C;return[t("div",ne,[t("div",oe,[((C=i.refs)==null?void 0:C.length)==0&&!i.brief?(e(),a("span",re,[g(r,{style:{"font-size":"16px"}}),n[0]||(n[0]=x(" 暂未释义"))])):(e(!0),a(f,{key:1},k(i.refs,(F,N)=>{var M;return e(),a("span",{class:"flex items-center",key:N},[g(h,{style:{"font-size":"16px"}}),x(" "+_((M=y(W)[F])!=null?M:""),1)])}),128))]),t("div",le,[g(Y,{text:i.text,yngping:i.pron},null,8,["text","yngping"])]),t("p",ie,_(y(I)(y(K)(i.brief))),1)])]}),_:2},1032,["to"]))),128)),n[1]||(n[1]=t("div",{class:"text-wheat-400 mt-6 text-center text-sm"},[x(" 没有找到想找的词汇？尝试"),t("a",{href:"https://jcnf40n3hvft.feishu.cn/share/base/form/shrcnfDrtD7nlpJdryFlYFUU3Lf",target:"_blank",class:"hover:text-wheat-600 underline underline-offset-4 transition-all"},"向我们反馈"),x("或"),t("a",{href:"https://jcnf40n3hvft.feishu.cn/share/base/form/shrcnAQ3W3DjmPV7ycTJ1ekiFBf",target:"_blank",class:"hover:text-wheat-600 underline underline-offset-4 transition-all"},"向我们提交数据")],-1)),p.value?(e(),a("div",ue,[t("button",{onClick:L,disabled:u.value,class:"bg-wheat-300 hover:bg-wheat-400 disabled:bg-wheat-200 rounded-lg px-6 py-3 text-white"},[t("div",{class:A({"animate-bounce":u.value})},"加载更多",2)],8,ce)])):j("",!0),!p.value&&c.value.length>0?(e(),a("div",de," 已显示所有 "+_(c.value.length)+" 条相关结果 ",1)):j("",!0)],64))]),_:1})}}});export{we as default};
