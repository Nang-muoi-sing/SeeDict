var ne=Object.defineProperty;var se=(t,e,o)=>e in t?ne(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o;var T=(t,e,o)=>se(t,typeof e!="symbol"?e+"":e,o);import{_ as Y}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{c as b,b as g,e as f,h as N,w as R,i as le,q as F,m as X,v as B,E as ie,G as ce,H as ue,I as ae,r as C,J as de,j as D,K as p,u as K,L as Q,d as fe,o as he,g as me,B as H,l as V,M as S,N as ve,F as pe,a as we,C as G,y as ye,t as be}from"./index-BGA_yeam.js";const ge={},_e={class:"flex h-full flex-row justify-between rounded-lg bg-white"},xe={class:"hover:bg-wheat-50 text-rosybrown-600 hover:text-rosybrown-800 m-1 content-center rounded-xs px-3 py-1.5 font-bold transition-all ease-in-out"},Te={class:"hover:bg-wheat-50 text-rosybrown-600 hover:text-rosybrown-800 m-1 content-center rounded-xs px-3 py-1.5 font-bold transition-all ease-in-out"};function ke(t,e){const o=le("RouterLink");return g(),b("div",_e,[f("div",xe,[N(o,{to:{name:"home"}},{default:R(()=>e[0]||(e[0]=[F("主页")])),_:1})]),e[2]||(e[2]=f("div",{class:"hover:bg-wheat-50 text-rosybrown-600 hover:text-rosybrown-800 m-1 content-center rounded-xs px-3 py-1.5 font-bold transition-all ease-in-out"},[f("a",{href:"#"},"入门")],-1)),f("div",Te,[N(o,{to:{name:"help"}},{default:R(()=>e[1]||(e[1]=[F("帮助")])),_:1})]),e[3]||(e[3]=f("div",{class:"hover:bg-wheat-50 text-rosybrown-600 hover:text-rosybrown-800 m-1 content-center rounded-xs px-3 py-1.5 font-bold transition-all ease-in-out"},[f("a",{href:"#"},"关于")],-1))])}const Ye=Y(ge,[["render",ke]]),Oe={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Ee(t,e){return g(),b("svg",Oe,e[0]||(e[0]=[f("path",{fill:"currentColor",d:"M12 21q-3.15 0-5.575-1.912T3.275 14.2q-.1-.375.15-.687t.675-.363q.4-.05.725.15t.45.6q.6 2.25 2.475 3.675T12 19q2.925 0 4.963-2.037T19 12t-2.037-4.962T12 5q-1.725 0-3.225.8T6.25 8H8q.425 0 .713.288T9 9t-.288.713T8 10H4q-.425 0-.712-.288T3 9V5q0-.425.288-.712T4 4t.713.288T5 5v1.35q1.275-1.6 3.113-2.475T12 3q1.875 0 3.513.713t2.85 1.924t1.925 2.85T21 12t-.712 3.513t-1.925 2.85t-2.85 1.925T12 21m1-9.4l2.5 2.5q.275.275.275.7t-.275.7t-.7.275t-.7-.275l-2.8-2.8q-.15-.15-.225-.337T11 11.975V8q0-.425.288-.712T12 7t.713.288T13 8z"},null,-1)]))}const Se=X({name:"material-symbols-history-rounded",render:Ee}),Ce={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function We(t,e){return g(),b("svg",Ce,e[0]||(e[0]=[f("path",{fill:"currentColor",d:"M9.5 16q-2.725 0-4.612-1.888T3 9.5t1.888-4.612T9.5 3t4.613 1.888T16 9.5q0 1.1-.35 2.075T14.7 13.3l5.6 5.6q.275.275.275.7t-.275.7t-.7.275t-.7-.275l-5.6-5.6q-.75.6-1.725.95T9.5 16m0-2q1.875 0 3.188-1.312T14 9.5t-1.312-3.187T9.5 5T6.313 6.313T5 9.5t1.313 3.188T9.5 14"},null,-1)]))}const qe=X({name:"material-symbols-search-rounded",render:We});function Z(t){return ie()?(ce(t),!0):!1}const ee=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const ze=Object.prototype.toString,He=t=>ze.call(t)==="[object Object]",y=()=>{},P=Ie();function Ie(){var t,e;return ee&&((t=window==null?void 0:window.navigator)==null?void 0:t.userAgent)&&(/iP(?:ad|hone|od)/.test(window.navigator.userAgent)||((e=window==null?void 0:window.navigator)==null?void 0:e.maxTouchPoints)>2&&/iPad|Macintosh/.test(window==null?void 0:window.navigator.userAgent))}function Ne(...t){if(t.length!==1)return ue(...t);const e=t[0];return typeof e=="function"?ae(de(()=>({get:e,set:y}))):C(e)}function $(t){return Array.isArray(t)?t:[t]}function De(t,e,o){return B(t,e,{...o,immediate:!0})}const te=ee?window:void 0;function W(t){var e;const o=p(t);return(e=o==null?void 0:o.$el)!=null?e:o}function k(...t){const e=[],o=()=>{e.forEach(l=>l()),e.length=0},r=(l,i,u,m)=>(l.addEventListener(i,u,m),()=>l.removeEventListener(i,u,m)),s=D(()=>{const l=$(p(t[0])).filter(i=>i!=null);return l.every(i=>typeof i!="string")?l:void 0}),d=De(()=>{var l,i;return[(i=(l=s.value)==null?void 0:l.map(u=>W(u)))!=null?i:[te].filter(u=>u!=null),$(p(s.value?t[1]:t[0])),$(K(s.value?t[2]:t[1])),p(s.value?t[3]:t[2])]},([l,i,u,m])=>{if(o(),!(l!=null&&l.length)||!(i!=null&&i.length)||!(u!=null&&u.length))return;const O=He(m)?{...m}:m;e.push(...l.flatMap(_=>i.flatMap(w=>u.map(E=>r(_,w,E,O)))))},{flush:"post"}),h=()=>{d(),o()};return Z(o),h}let J=!1;function U(t,e,o={}){const{window:r=te,ignore:s=[],capture:d=!0,detectIframe:h=!1,controls:l=!1}=o;if(!r)return l?{stop:y,cancel:y,trigger:y}:y;if(P&&!J){J=!0;const c={passive:!0};Array.from(r.document.body.children).forEach(n=>k(n,"click",y,c)),k(r.document.documentElement,"click",y,c)}let i=!0;const u=c=>p(s).some(n=>{if(typeof n=="string")return Array.from(r.document.querySelectorAll(n)).some(a=>a===c.target||c.composedPath().includes(a));{const a=W(n);return a&&(c.target===a||c.composedPath().includes(a))}});function m(c){const n=p(c);return n&&n.$.subTree.shapeFlag===16}function O(c,n){const a=p(c),v=a.$.subTree&&a.$.subTree.children;return v==null||!Array.isArray(v)?!1:v.some(x=>x.el===n.target||n.composedPath().includes(x.el))}const _=c=>{const n=W(t);if(c.target!=null&&!(!(n instanceof Element)&&m(t)&&O(t,c))&&!(!n||n===c.target||c.composedPath().includes(n))){if("detail"in c&&c.detail===0&&(i=!u(c)),!i){i=!0;return}e(c)}};let w=!1;const E=[k(r,"click",c=>{w||(w=!0,setTimeout(()=>{w=!1},0),_(c))},{passive:!0,capture:d}),k(r,"pointerdown",c=>{const n=W(t);i=!u(c)&&!!(n&&!c.composedPath().includes(n))},{passive:!0}),h&&k(r,"blur",c=>{setTimeout(()=>{var n;const a=W(t);((n=r.document.activeElement)==null?void 0:n.tagName)==="IFRAME"&&!(a!=null&&a.contains(r.document.activeElement))&&e(c)},0)},{passive:!0})].filter(Boolean),z=()=>E.forEach(c=>c());return l?{stop:z,cancel:()=>{i=!1},trigger:c=>{i=!0,_(c),i=!1}}:z}const Le={mounted(t,e){const o=!e.modifiers.bubble;if(typeof e.value=="function")t.__onClickOutside_stop=U(t,e.value,{capture:o});else{const[r,s]=e.value;t.__onClickOutside_stop=U(t,r,Object.assign({capture:o},s))}},unmounted(t){t.__onClickOutside_stop()}};function j(t){return typeof Window<"u"&&t instanceof Window?t.document.documentElement:typeof Document<"u"&&t instanceof Document?t.documentElement:t}function oe(t){const e=window.getComputedStyle(t);if(e.overflowX==="scroll"||e.overflowY==="scroll"||e.overflowX==="auto"&&t.clientWidth<t.scrollWidth||e.overflowY==="auto"&&t.clientHeight<t.scrollHeight)return!0;{const o=t.parentNode;return!o||o.tagName==="BODY"?!1:oe(o)}}function Me(t){const e=t||window.event,o=e.target;return oe(o)?!1:e.touches.length>1?!0:(e.preventDefault&&e.preventDefault(),!1)}const A=new WeakMap;function $e(t,e=!1){const o=Q(e);let r=null,s="";B(Ne(t),l=>{const i=j(p(l));if(i){const u=i;if(A.get(u)||A.set(u,u.style.overflow),u.style.overflow!=="hidden"&&(s=u.style.overflow),u.style.overflow==="hidden")return o.value=!0;if(o.value)return u.style.overflow="hidden"}},{immediate:!0});const d=()=>{const l=j(p(t));!l||o.value||(P&&(r=k(l,"touchmove",i=>{Me(i)},{passive:!1})),l.style.overflow="hidden",o.value=!0)},h=()=>{const l=j(p(t));!l||!o.value||(P&&(r==null||r()),l.style.overflow=s,A.delete(l),o.value=!1)};return Z(h),D({get(){return o.value},set(l){l?d():h()}})}function je(){let t=!1;const e=Q(!1);return(o,r)=>{if(e.value=r.value,t)return;t=!0;const s=$e(o,r.value);B(e,d=>s.value=d)}}je();class I{constructor(){T(this,"children");T(this,"isEndOfWord");T(this,"timestamp");this.children={},this.isEndOfWord=!1,this.timestamp=null}}class q{constructor(){T(this,"root");T(this,"size");this.root=new I,this.size=0}clear(){this.root=new I,this.size=0}insert(e){let o=this.root;for(const r of e)o.children[r]||(o.children[r]=new I),o=o.children[r];o.isEndOfWord||this.size++,o.isEndOfWord=!0,o.timestamp=Date.now()}delete(e){const o=(r,s)=>{if(s===e.length)return r.isEndOfWord?(r.isEndOfWord=!1,this.size--,Object.keys(r.children).length===0):!1;const d=e[s],h=r.children[d];return h&&o(h,s+1)?(delete r.children[d],Object.keys(r.children).length===0):!1};o(this.root,0)}findWords(e){let o=this.root;for(const r of e){if(!o.children[r])return[];o=o.children[r]}return this.collectWords(o,e)}collectWords(e,o){const r=[];e.isEndOfWord&&e.timestamp&&r.push({word:o,timestamp:e.timestamp});for(const s in e.children)r.push(...this.collectWords(e.children[s],o+s));return r}serialize(){function e(o){return{isEndOfWord:o.isEndOfWord,timestamp:o.timestamp,children:Object.fromEntries(Object.entries(o.children).map(([r,s])=>[r,e(s)]))}}return JSON.stringify(e(this.root))}static deserialize(e){const o=new q;function r(s){const d=new I;d.isEndOfWord=s.isEndOfWord,d.timestamp=s.timestamp;for(const[h,l]of Object.entries(s.children))d.children[h]=r(l);return d}return o.root=r(JSON.parse(e)),o}}const Ae={class:"outline-rosybrown-300 absolute top-full right-0 left-0 rounded-b-md bg-white pt-2 outline"},Pe=["onClick"],Be={class:"text-rosybrown-600 overflow-hidden text-ellipsis"},Re=["onClick"],Fe={class:"flex flex-row-reverse items-baseline px-4 py-1"},Ve=fe({__name:"SearchBar",setup(t){const e=ye(),o=C(""),r=C([]),s=C(!1),d=C(!1),h=()=>{s.value=!1};he(()=>{window.addEventListener("scroll",h)}),me(()=>{window.removeEventListener("scroll",h)});const i=(n=>{try{return n?q.deserialize(n):new q}catch(a){return console.error("反序列化前缀树时出错:",a),new q}})(localStorage.getItem("searchHistory")),u=()=>{const n=o.value;if(n){i.insert(n);try{localStorage.setItem("searchHistory",i.serialize())}finally{o.value=""}}s.value=!1,d.value=!1,e.push({name:"search",query:{q:n}})},m=()=>{s.value=!0;const n=o.value,a=i.findWords(n);if(a.length<2){r.value=a.map(v=>v.word);return}a.sort((v,x)=>x.timestamp-v.timestamp),r.value=a.map(v=>v.word).slice(0,10)},O=n=>{o.value=r.value[n],u()},_=n=>{i.delete(r.value.splice(n,1)[0]),localStorage.setItem("searchHistory",i.serialize())},w=()=>{r.value=[],i.clear(),localStorage.removeItem("searchHistory")},E=n=>{n.target.tagName==="INPUT"&&(s.value=!0,d.value=!0)},z=D(()=>s.value&&r.value.length>0?["rounded-b-none","rounded-t-[24px]"]:["rounded-[3rem]"]),c=D(()=>s.value?["backdrop-blur-xs","backdrop-brightness-90"]:["hidden"]);return(n,a)=>{const v=qe,x=Se;return g(),b("div",null,[f("div",{class:V(["fixed top-0 left-0 z-50 h-screen w-screen",c.value])},null,2),H((g(),b("form",{class:V(["outline-rosybrown-300 hover:outline-rosybrown-400 relative z-100 flex h-12 flex-row items-center space-x-2 bg-white px-3 outline-2 hover:outline-3",z.value]),onSubmit:S(u,["prevent"]),onClick:E},[N(v,{width:"28",height:"28",class:"text-rosybrown-400 hover:text-rosybrown-700 cursor-pointer pl-1",onClick:S(u,["stop"])}),H(f("input",{class:"text-rosybrown-800 h-full w-full","onUpdate:modelValue":a[0]||(a[0]=L=>o.value=L),onInput:m,onFocus:m},null,544),[[ve,o.value,void 0,{trim:!0}]]),H(f("ul",Ae,[(g(!0),b(pe,null,we(r.value,(L,M)=>(g(),b("li",{key:M,class:"hover:border-l-rosybrown-700 hover:text-rosybrown-700 hover:bg-rosybrown-50 box-border flex flex-row items-center justify-between border-l-3 border-l-transparent px-4 py-1"},[f("div",{class:"flex w-7/8 cursor-pointer flex-row items-center font-sans",onClick:S(re=>O(M),["stop"])},[N(x,{class:"text-rosybrown-400 pr-4",style:{width:"40px"}}),f("div",Be,be(L),1)],8,Pe),f("div",{class:"text-rosybrown-300 hover:text-rosybrown-500 cursor-pointer text-sm hover:underline",onClick:S(re=>_(M),["stop"])}," 删除 ",8,Re)]))),128)),H(f("li",Fe,[f("div",{class:"text-rosybrown-300 hover:text-rosybrown-500 cursor-pointer text-xs",onClick:S(w,["stop"])}," 清空历史 ")],512),[[G,s.value&&r.value.length>0]])],512),[[G,s.value&&r.value.length>0]])],34)),[[K(Le),()=>{s.value=!1}]])])}}}),Xe=Y(Ve,[["__scopeId","data-v-d97f6dc4"]]);export{Ye as N,Xe as S};
